<!-- new analytics setting : insert setting in pelicanconf/publisheconf -->
{% if ANALYTICS %} {{ ANALYTICS }} {% endif %}
<!--
reference: this source import pelican repository
https://github.com/getpelican/pelican/blob/master/pelican/themes/notmyidea/templates/analytics.html
reference: GOOGLE_ANALYTICS_UNIVERSAL tag by `pelican-bootstrap3`
https://github.com/DandyDev/pelican-bootstrap3/blob/master/templates/includes/ga.html
 -->

{% if GOOGLE_ANALYTICS %}
<script type="text/javascript">
  var _gaq = _gaq || []
  _gaq.push(['_setAccount', '{{GOOGLE_ANALYTICS}}'])
  _gaq.push(['_trackPageview'])
  ;(function () {
    var ga = document.createElement('script')
    ga.type = 'text/javascript'
    ga.async = true
    ga.src =
      ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +
      '.google-analytics.com/ga.js'
    var s = document.getElementsByTagName('script')[0]
    s.parentNode.insertBefore(ga, s)
  })()
</script>
{% endif %}

<!-- Google Analytics Universal -->
{% if GOOGLE_ANALYTICS_UNIVERSAL %}
<script type="text/javascript">
  ;(function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r
    ;(i[r] =
      i[r] ||
      function () {
        ;(i[r].q = i[r].q || []).push(arguments)
      }),
      (i[r].l = 1 * new Date())
    ;(a = s.createElement(o)), (m = s.getElementsByTagName(o)[0])
    a.async = 1
    a.src = g
    m.parentNode.insertBefore(a, m)
  })(
    window,
    document,
    'script',
    '//www.google-analytics.com/analytics.js',
    'ga'
  )
  ga(
    'create',
    '{{ GOOGLE_ANALYTICS_UNIVERSAL }}',
    '{{ GOOGLE_ANALYTICS_UNIVERSAL_PROPERTY }}'
  )
  ga('send', 'pageview')
</script>
<!-- End Google Analytics Universal Code -->
{% endif %}

<!-- GAUGES -->
{% if GAUGES %}
<script type="text/javascript">
  var _gauges = _gauges || []
  ;(function () {
    var t = document.createElement('script')
    t.type = 'text/javascript'
    t.async = true
    t.id = 'gauges-tracker'
    t.setAttribute('data-site-id', '{{GAUGES}}')
    t.src = '//secure.gaug.es/track.js'
    var s = document.getElementsByTagName('script')[0]
    s.parentNode.insertBefore(t, s)
  })()
</script>
{% endif %}

<!-- ?? -->
{% if PIWIK_URL and PIWIK_SITE_ID %}
<script type="text/javascript">
  {% if PIWIK_SSL_URL %}
      var pkBaseURL = "{{ PIWIK_SSL_URL }}";
  {% else %}
      var pkBaseURL = "{{ PIWIK_URL }}";
  {% endif %}
  var _paq = _paq || [];
  _paq.push(["trackPageView"]);
  _paq.push(["enableLinkTracking"]);
  (function() {
      var u=(("https:" == document.location.protocol) ? "https" : "http")+"://"+pkBaseURL+"/";
      _paq.push(["setTrackerUrl", u+"piwik.php"]);
      _paq.push(["setSiteId", "{{ PIWIK_SITE_ID }}"]);
      var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
      g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
  })();
</script>
{% endif %}
